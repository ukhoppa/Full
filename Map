-- // Map Scanner GUI (LocalScript)
-- Place this in StarterPlayerScripts or StarterGui

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")

local player = Players.LocalPlayer
local char = player.Character or player.CharacterAdded:Wait()
local hrp = char:WaitForChild("HumanoidRootPart")

-- GUI Setup
local gui = Instance.new("ScreenGui")
gui.Name = "MapScannerGUI"
gui.ResetOnSpawn = false
gui.Parent = player:WaitForChild("PlayerGui")

local frame = Instance.new("Frame")
frame.Size = UDim2.new(0, 260, 0, 220)
frame.Position = UDim2.new(0, 10, 1, -230)
frame.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
frame.BorderSizePixel = 0
frame.Active = true
frame.Draggable = true
frame.Parent = gui

local title = Instance.new("TextLabel")
title.Text = "ðŸ§­ Map Scanner"
title.Size = UDim2.new(1, 0, 0, 30)
title.BackgroundTransparency = 1
title.TextColor3 = Color3.fromRGB(255, 255, 255)
title.Font = Enum.Font.SourceSansBold
title.TextSize = 18
title.Parent = frame

-- Step size input
local stepLabel = Instance.new("TextLabel")
stepLabel.Text = "Step size (studs):"
stepLabel.Position = UDim2.new(0, 10, 0, 40)
stepLabel.Size = UDim2.new(0, 130, 0, 25)
stepLabel.BackgroundTransparency = 1
stepLabel.TextColor3 = Color3.new(1, 1, 1)
stepLabel.Parent = frame

local stepBox = Instance.new("TextBox")
stepBox.Position = UDim2.new(0, 150, 0, 40)
stepBox.Size = UDim2.new(0, 80, 0, 25)
stepBox.Text = "5"
stepBox.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
stepBox.TextColor3 = Color3.new(1, 1, 1)
stepBox.ClearTextOnFocus = false
stepBox.Parent = frame

-- Height input
local heightLabel = Instance.new("TextLabel")
heightLabel.Text = "Height (Y):"
heightLabel.Position = UDim2.new(0, 10, 0, 70)
heightLabel.Size = UDim2.new(0, 130, 0, 25)
heightLabel.BackgroundTransparency = 1
heightLabel.TextColor3 = Color3.new(1, 1, 1)
heightLabel.Parent = frame

local heightBox = Instance.new("TextBox")
heightBox.Position = UDim2.new(0, 150, 0, 70)
heightBox.Size = UDim2.new(0, 80, 0, 25)
heightBox.Text = "10"
heightBox.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
heightBox.TextColor3 = Color3.new(1, 1, 1)
heightBox.ClearTextOnFocus = false
heightBox.Parent = frame

-- Heartbeat slider
local tickLabel = Instance.new("TextLabel")
tickLabel.Text = "TP every 1 heartbeat(s)"
tickLabel.Position = UDim2.new(0, 10, 0, 100)
tickLabel.Size = UDim2.new(1, -20, 0, 20)
tickLabel.BackgroundTransparency = 1
tickLabel.TextColor3 = Color3.new(1, 1, 1)
tickLabel.Font = Enum.Font.SourceSans
tickLabel.TextSize = 14
tickLabel.Parent = frame

local sliderBg = Instance.new("Frame")
sliderBg.Position = UDim2.new(0, 10, 0, 125)
sliderBg.Size = UDim2.new(1, -20, 0, 6)
sliderBg.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
sliderBg.BorderSizePixel = 0
sliderBg.Parent = frame

local sliderFill = Instance.new("Frame")
sliderFill.Size = UDim2.new(1/60, 0, 1, 0) -- initial 1/60
sliderFill.BackgroundColor3 = Color3.fromRGB(0, 180, 255)
sliderFill.BorderSizePixel = 0
sliderFill.Parent = sliderBg

local tickSpeed = 6
local heartbeatCounter = 0
local dragging = false

sliderBg.InputBegan:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.MouseButton1 then
		dragging = true
	end
end)

UserInputService.InputEnded:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.MouseButton1 then
		dragging = false
	end
end)

UserInputService.InputChanged:Connect(function(input)
	if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
		local relX = math.clamp((input.Position.X - sliderBg.AbsolutePosition.X) / sliderBg.AbsoluteSize.X, 0, 1)
		sliderFill.Size = UDim2.new(relX, 0, 1, 0)
		tickSpeed = math.max(1, math.round(relX * 60))
		tickLabel.Text = "TP every " .. tickSpeed .. " heartbeat(s)"
	end
end)

-- Buttons
local startBtn = Instance.new("TextButton")
startBtn.Text = "â–¶ Start Scan"
startBtn.Size = UDim2.new(0, 110, 0, 30)
startBtn.Position = UDim2.new(0, 10, 0, 160)
startBtn.BackgroundColor3 = Color3.fromRGB(0, 180, 0)
startBtn.TextColor3 = Color3.new(1, 1, 1)
startBtn.Font = Enum.Font.SourceSansBold
startBtn.TextSize = 14
startBtn.Parent = frame

local stopBtn = Instance.new("TextButton")
stopBtn.Text = "â›” Stop"
stopBtn.Size = UDim2.new(0, 110, 0, 30)
stopBtn.Position = UDim2.new(0, 140, 0, 160)
stopBtn.BackgroundColor3 = Color3.fromRGB(180, 0, 0)
stopBtn.TextColor3 = Color3.new(1, 1, 1)
stopBtn.Font = Enum.Font.SourceSansBold
stopBtn.TextSize = 14
stopBtn.Parent = frame

-- Scanning logic
local scanning = false
local connection

local function startScanning()
	if scanning then return end
	scanning = true
	startBtn.Text = "Running..."
	startBtn.BackgroundColor3 = Color3.fromRGB(100, 100, 100)

	local step = 40
	local height = 20
	local radius = 1368
	local angleStep = math.rad(5)
	local ring = radius
	local angle = 0
	heartbeatCounter = 0

	connection = RunService.Heartbeat:Connect(function()
		if not scanning then return end

		heartbeatCounter += 1
		if heartbeatCounter >= tickSpeed then
			heartbeatCounter = 0

			-- Teleport once per tickSpeed heartbeats
			local x = math.cos(angle) * ring
			local z = math.sin(angle) * ring
			local newPos = Vector3.new(x, height, z)
			hrp.CFrame = CFrame.new(newPos)

			angle += angleStep
			if angle >= math.pi * 2 then
				angle = 0
				ring -= step
				if ring <= 0 then
					print("âœ… Scan complete")
					scanning = false
					connection:Disconnect()
					startBtn.Text = "â–¶ Start Scan"
					startBtn.BackgroundColor3 = Color3.fromRGB(0, 180, 0)
					return
				end
			end
		end
	end)
end

local function stopScanning()
	if scanning then
		scanning = false
		if connection then connection:Disconnect() end
		startBtn.Text = "â–¶ Start Scan"
		startBtn.BackgroundColor3 = Color3.fromRGB(0, 180, 0)
		print("ðŸ›‘ Scan stopped manually")
	end
end

startBtn.MouseButton1Click:Connect(startScanning)
stopBtn.MouseButton1Click:Connect(stopScanning)
